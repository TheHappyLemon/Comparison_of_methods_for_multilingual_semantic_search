The Novgorod Republic (Russian: Новгородская республика) was a medieval state that existed from the 12th to 15th centuries in northern Russia, stretching from the Gulf of Finland in the west to the northern Ural Mountains in the east. Its capital was the city of Novgorod. The republic prospered as the easternmost trading post of the Hanseatic League, and its people were much influenced by the culture of the Byzantines, with the Novgorod school of icon painting producing many fine works. Novgorod won its independence in 1136 after the Novgorodians deposed their prince and the Novgorod veche began to elect and dismiss princes at its own will. The veche also elected the posadnik, who was the chief executive of the city, and from 1156, the archbishop of Novgorod, subject to approval by the Russian metropolitan. The tysyatsky was also elected by the veche, who was originally the military commander, and served the interests of the common people. Novgorodian nobles known as boyars dominated the veche, and the offices of posadnik and tysyatsky remained in the hands of boyar families. The boyars also gave funding to the ushkuyniki, who contributed to the expansion of Novgorod's trade and colonies in the north of European Russia. By the 14th century, the prince of Moscow (who was almost always the grand prince of Vladimir) was usually the prince of Novgorod as well. As Moscow grew in power in the 15th century, Novgorod began to lose its autonomy. In a 1471 peace treaty with Moscow following the Battle of Shelon, Novgorod pledged allegiance to Moscow, with its system of government temporarily left intact. The end of the republic and the veche came in 1478 when Ivan III once again invaded and seized the city as part of his campaign to annex all other Russian states.