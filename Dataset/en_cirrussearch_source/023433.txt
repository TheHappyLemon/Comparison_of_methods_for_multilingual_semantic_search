In linear algebra, Cramer's rule is an explicit formula for the solution of a system of linear equations with as many equations as unknowns, valid whenever the system has a unique solution. It expresses the solution in terms of the determinants of the (square) coefficient matrix and of matrices obtained from it by replacing one column by the column vector of right-sides of the equations. It is named after Gabriel Cramer, who published the rule for an arbitrary number of unknowns in 1750, although Colin Maclaurin also published special cases of the rule in 1748, and possibly knew of it as early as 1729. Cramer's rule implemented in a naive way is computationally inefficient for systems of more than two or three equations. In the case of n equations in n unknowns, it requires computation of n + 1 determinants, while Gaussian elimination produces the result with the same computational complexity as the computation of a single determinant.[verification needed] Cramer's rule can also be numerically unstable even for 2×2 systems. However, Cramer's rule can be implemented with the same complexity as Gaussian elimination, (consistently requires twice as many arithmetic operations and has the same numerical stability when the same permutation matrices are applied). Consider a system of n linear equations for n unknowns, represented in matrix multiplication form as follows: Ax=b{\displaystyle A\mathbf {x} =\mathbf {b} } where the n × n matrix A has a nonzero determinant, and the vector x=(x1,…,xn)T{\displaystyle \mathbf {x} =(x_{1},\ldots ,x_{n})^{\mathsf {T}}} is the column vector of the variables. Then the theorem states that in this case the system has a unique solution, whose individual values for the unknowns are given by: xi=det(Ai)det(A)i=1,…,n{\displaystyle x_{i}={\frac {\det(A_{i})}{\det(A)}}\qquad i=1,\ldots ,n} where Ai{\displaystyle A_{i}} is the matrix formed by replacing the i-th column of A by the column vector b. A more general version of Cramer's rule considers the matrix equation AX=B{\displaystyle AX=B} where the n × n matrix A has a nonzero determinant, and X, B are n × m matrices. Given sequences 1≤i1<i2<⋯<ik≤n{\displaystyle 1\leq i_{1}<i_{2}<\cdots <i_{k}\leq n} and 1≤j1<j2<⋯<jk≤m{\displaystyle 1\leq j_{1}<j_{2}<\cdots <j_{k}\leq m}, let XI,J{\displaystyle X_{I,J}} be the k × k submatrix of X with rows in I:=(i1,…,ik){\displaystyle I:=(i_{1},\ldots ,i_{k})} and columns in J:=(j1,…,jk){\displaystyle J:=(j_{1},\ldots ,j_{k})}. Let AB(I,J){\displaystyle A_{B}(I,J)} be the n × n matrix formed by replacing the is{\displaystyle i_{s}} column of A by the js{\displaystyle j_{s}} column of B, for all s=1,…,k{\displaystyle s=1,\ldots ,k}. Then detXI,J=det(AB(I,J))det(A).{\displaystyle \det X_{I,J}={\frac {\det(A_{B}(I,J))}{\det(A)}}.} In the case k=1{\displaystyle k=1}, this reduces to the normal Cramer's rule. The rule holds for systems of equations with coefficients and unknowns in any field, not just in the real numbers. The proof for Cramer's rule uses the following properties of the determinants: linearity with respect to any given column and the fact that the determinant is zero whenever two columns are equal, which is implied by the property that the sign of the determinant flips if you switch two columns. Fix the index j of a column, and consider that the entries of the other columns have fixed values. This makes the determinant a function of the entries of the jth column. Linearity with respect of this column means that this function has the form Dj(a1,j,…,an,j)=C1,ja1,j+⋯,Cn,jan,j,{\displaystyle D_{j}(a_{1,j},\ldots ,a_{n,j})=C_{1,j}a_{1,j}+\cdots ,C_{n,j}a_{n,j},} where the Ci,j{\displaystyle C_{i,j}} are coefficients that depend on the entries of A that are not in column j. So, one has det(A)=Dj(a1,j,…,an,j)=C1,ja1,j+⋯,Cn,jan,j{\displaystyle \det(A)=D_{j}(a_{1,j},\ldots ,a_{n,j})=C_{1,j}a_{1,j}+\cdots ,C_{n,j}a_{n,j}} (Laplace expansion provides a formula for computing the Ci,j{\displaystyle C_{i,j}} but their expression is not important here.) If the function Dj{\displaystyle D_{j}} is applied to any other column k of A, then the result is the determinant of the matrix obtained from A by replacing column j by a copy of column k, so the resulting determinant is 0 (the case of two equal columns). Now consider a system of n linear equations in n unknowns x1,…,xn{\displaystyle x_{1},\ldots ,x_{n}}, whose coefficient matrix is A, with det(A) assumed to be nonzero: a11x1+a12x2+⋯+a1nxn=b1a21x1+a22x2+⋯+a2nxn=b2⋮an1x1+an2x2+⋯+annxn=bn.{\displaystyle {\begin{matrix}a_{11}x_{1}+a_{12}x_{2}+\cdots +a_{1n}x_{n}&=&b_{1}\\a_{21}x_{1}+a_{22}x_{2}+\cdots +a_{2n}x_{n}&=&b_{2}\\&\vdots &\\a_{n1}x_{1}+a_{n2}x_{2}+\cdots +a_{nn}x_{n}&=&b_{n}.\end{matrix}}} If one combines these equations by taking C1,j times the first equation, plus C2,j times the second, and so forth until Cn,j times the last, then for every k the resulting coefficient of xk becomes Dj(a1,k,…,an,k).{\displaystyle D_{j}(a_{1,k},\ldots ,a_{n,k}).} So, all coefficients become zero, except the coefficient of xj{\displaystyle x_{j}} that becomes det(A).{\displaystyle \det(A).} Similarly, the constant coefficient becomes Dj(b1,…,bn),{\displaystyle D_{j}(b_{1},\ldots ,b_{n}),} and the resulting equation is thus det(A)xj=Dj(b1,…,bn),{\displaystyle \det(A)x_{j}=D_{j}(b_{1},\ldots ,b_{n}),} which gives the value of xj{\displaystyle x_{j}} as xj=1det(A)Dj(b1,…,bn).{\displaystyle x_{j}={\frac {1}{\det(A)}}D_{j}(b_{1},\ldots ,b_{n}).} As, by construction, the numerator is the determinant of the matrix obtained from A by replacing column j by b, we get the expression of Cramer's rule as a necessary condition for a solution. It remains to prove that these values for the unknowns form a solution. Let M be the n × n matrix that has the coefficients of Dj{\displaystyle D_{j}} as jth row, for j=1,…,n{\displaystyle j=1,\ldots ,n} (this is the adjugate matrix for A). Expressed in matrix terms, we have thus to prove that x=1det(A)Mb{\displaystyle \mathbf {x} ={\frac {1}{\det(A)}}M\mathbf {b} } is a solution; that is, that A(1det(A)M)b=b.{\displaystyle A\left({\frac {1}{\det(A)}}M\right)\mathbf {b} =\mathbf {b} .} For that, it suffices to prove that A(1det(A)M)=In,{\displaystyle A\,\left({\frac {1}{\det(A)}}M\right)=I_{n},} where In{\displaystyle I_{n}} is the identity matrix. The above properties of the functions Dj{\displaystyle D_{j}} show that one has MA = det(A)In, and therefore, (1det(A)M)A=In.{\displaystyle \left({\frac {1}{\det(A)}}M\right)\,A=I_{n}.} This completes the proof, since a left inverse of a square matrix is also a right-inverse (see Invertible matrix theorem). For other proofs, see below. Let A be an n × n matrix with entries in a field F. Then Aadj⁡(A)=adj⁡(A)A=det(A)I{\displaystyle A\,\operatorname {adj} (A)=\operatorname {adj} (A)\,A=\det(A)I} where adj(A) denotes the adjugate matrix, det(A) is the determinant, and I is the identity matrix. If det(A) is nonzero, then the inverse matrix of A is A−1=1det(A)adj⁡(A).{\displaystyle A^{-1}={\frac {1}{\det(A)}}\operatorname {adj} (A).} This gives a formula for the inverse of A, provided det(A) ≠ 0. In fact, this formula works whenever F is a commutative ring, provided that det(A) is a unit. If det(A) is not a unit, then A is not invertible over the ring (it may be invertible over a larger ring in which some non-unit elements of F may be invertible). Consider the linear system {a1x+b1y=c1a2x+b2y=c2{\displaystyle \left\{{\begin{matrix}a_{1}x+b_{1}y&={\color {red}c_{1}}\\a_{2}x+b_{2}y&={\color {red}c_{2}}\end{matrix}}\right.} which in matrix format is [a1b1a2b2][xy]=[c1c2].{\displaystyle {\begin{bmatrix}a_{1}&b_{1}\\a_{2}&b_{2}\end{bmatrix}}{\begin{bmatrix}x\\y\end{bmatrix}}={\begin{bmatrix}{\color {red}c_{1}}\\{\color {red}c_{2}}\end{bmatrix}}.} Assume a1b2 − b1a2 is nonzero. Then, with the help of determinants, x and y can be found with Cramer's rule as x=|c1b1c2b2||a1b1a2b2|=c1b2−b1c2a1b2−b1a2,y=|a1c1a2c2||a1b1a2b2|=a1c2−c1a2a1b2−b1a2.{\displaystyle {\begin{aligned}x&={\frac {\begin{vmatrix}{\color {red}{c_{1}}}&b_{1}\\{\color {red}{c_{2}}}&b_{2}\end{vmatrix}}{\begin{vmatrix}a_{1}&b_{1}\\a_{2}&b_{2}\end{vmatrix}}}={{\color {red}c_{1}}b_{2}-b_{1}{\color {red}c_{2}} \over a_{1}b_{2}-b_{1}a_{2}},\quad y={\frac {\begin{vmatrix}a_{1}&{\color {red}{c_{1}}}\\a_{2}&{\color {red}{c_{2}}}\end{vmatrix}}{\begin{vmatrix}a_{1}&b_{1}\\a_{2}&b_{2}\end{vmatrix}}}={a_{1}{\color {red}c_{2}}-{\color {red}c_{1}}a_{2} \over a_{1}b_{2}-b_{1}a_{2}}\end{aligned}}.} The rules for 3 × 3 matrices are similar. Given {a1x+b1y+c1z=d1a2x+b2y+c2z=d2a3x+b3y+c3z=d3{\displaystyle \left\{{\begin{matrix}a_{1}x+b_{1}y+c_{1}z&={\color {red}d_{1}}\\a_{2}x+b_{2}y+c_{2}z&={\color {red}d_{2}}\\a_{3}x+b_{3}y+c_{3}z&={\color {red}d_{3}}\end{matrix}}\right.} which in matrix format is [a1b1c1a2b2c2a3b3c3][xyz]=[d1d2d3].{\displaystyle {\begin{bmatrix}a_{1}&b_{1}&c_{1}\\a_{2}&b_{2}&c_{2}\\a_{3}&b_{3}&c_{3}\end{bmatrix}}{\begin{bmatrix}x\\y\\z\end{bmatrix}}={\begin{bmatrix}{\color {red}d_{1}}\\{\color {red}d_{2}}\\{\color {red}d_{3}}\end{bmatrix}}.} Then the values of x, y and z can be found as follows: x=|d1b1c1d2b2c2d3b3c3||a1b1c1a2b2c2a3b3c3|,y=|a1d1c1a2d2c2a3d3c3||a1b1c1a2b2c2a3b3c3|, and z=|a1b1d1a2b2d2a3b3d3||a1b1c1a2b2c2a3b3c3|.{\displaystyle x={\frac {\begin{vmatrix}{\color {red}d_{1}}&b_{1}&c_{1}\\{\color {red}d_{2}}&b_{2}&c_{2}\\{\color {red}d_{3}}&b_{3}&c_{3}\end{vmatrix}}{\begin{vmatrix}a_{1}&b_{1}&c_{1}\\a_{2}&b_{2}&c_{2}\\a_{3}&b_{3}&c_{3}\end{vmatrix}}},\quad y={\frac {\begin{vmatrix}a_{1}&{\color {red}d_{1}}&c_{1}\\a_{2}&{\color {red}d_{2}}&c_{2}\\a_{3}&{\color {red}d_{3}}&c_{3}\end{vmatrix}}{\begin{vmatrix}a_{1}&b_{1}&c_{1}\\a_{2}&b_{2}&c_{2}\\a_{3}&b_{3}&c_{3}\end{vmatrix}}},{\text{ and }}z={\frac {\begin{vmatrix}a_{1}&b_{1}&{\color {red}d_{1}}\\a_{2}&b_{2}&{\color {red}d_{2}}\\a_{3}&b_{3}&{\color {red}d_{3}}\end{vmatrix}}{\begin{vmatrix}a_{1}&b_{1}&c_{1}\\a_{2}&b_{2}&c_{2}\\a_{3}&b_{3}&c_{3}\end{vmatrix}}}.} Cramer's rule is used in the Ricci calculus in various calculations involving the Christoffel symbols of the first and second kind. In particular, Cramer's rule can be used to prove that the divergence operator on a Riemannian manifold is invariant with respect to change of coordinates. We give a direct proof, suppressing the role of the Christoffel symbols. Let (M,g){\displaystyle (M,g)} be a Riemannian manifold equipped with local coordinates (x1,x2,…,xn){\displaystyle (x^{1},x^{2},\dots ,x^{n})}. Let A=Ai∂∂xi{\displaystyle A=A^{i}{\frac {\partial }{\partial x^{i}}}} be a vector field. We use the summation convention throughout. Theorem. The divergence of A{\displaystyle A}, div⁡A=1detg∂∂xi(Aidetg),{\displaystyle \operatorname {div} A={\frac {1}{\sqrt {\det g}}}{\frac {\partial }{\partial x^{i}}}\left(A^{i}{\sqrt {\det g}}\right),} is invariant under change of coordinates. Consider the two equations F(x,y,u,v)=0{\displaystyle F(x,y,u,v)=0} and G(x,y,u,v)=0{\displaystyle G(x,y,u,v)=0}. When u and v are independent variables, we can define x=X(u,v){\displaystyle x=X(u,v)} and y=Y(u,v).{\displaystyle y=Y(u,v).} An equation for ∂x∂u{\displaystyle {\dfrac {\partial x}{\partial u}}} can be found by applying Cramer's rule. Cramer's rule can be used to prove that an integer programming problem whose constraint matrix is totally unimodular and whose right-hand side is integer, has integer basic solutions. This makes the integer program substantially easier to solve. Cramer's rule is used to derive the general solution to an inhomogeneous linear differential equation by the method of variation of parameters. Cramer's rule has a geometric interpretation that can be considered also a proof or simply giving insight about its geometric nature. These geometric arguments work in general and not only in the case of two equations with two unknowns presented here. Given the system of equations a11x1+a12x2=b1a21x1+a22x2=b2{\displaystyle {\begin{matrix}a_{11}x_{1}+a_{12}x_{2}&=b_{1}\\a_{21}x_{1}+a_{22}x_{2}&=b_{2}\end{matrix}}} it can be considered as an equation between vectors x1(a11a21)+x2(a12a22)=(b1b2).{\displaystyle x_{1}{\binom {a_{11}}{a_{21}}}+x_{2}{\binom {a_{12}}{a_{22}}}={\binom {b_{1}}{b_{2}}}.} The area of the parallelogram determined by (a11a21){\displaystyle {\binom {a_{11}}{a_{21}}}} and (a12a22){\displaystyle {\binom {a_{12}}{a_{22}}}} is given by the determinant of the system of equations: |a11a12a21a22|.{\displaystyle {\begin{vmatrix}a_{11}&a_{12}\\a_{21}&a_{22}\end{vmatrix}}.} In general, when there are more variables and equations, the determinant of n vectors of length n will give the volume of the parallelepiped determined by those vectors in the n-th dimensional Euclidean space. Therefore, the area of the parallelogram determined by x1(a11a21){\displaystyle x_{1}{\binom {a_{11}}{a_{21}}}} and (a12a22){\displaystyle {\binom {a_{12}}{a_{22}}}} has to be x1{\displaystyle x_{1}} times the area of the first one since one of the sides has been multiplied by this factor. Now, this last parallelogram, by Cavalieri's principle, has the same area as the parallelogram determined by (b1b2)=x1(a11a21)+x2(a12a22){\displaystyle {\binom {b_{1}}{b_{2}}}=x_{1}{\binom {a_{11}}{a_{21}}}+x_{2}{\binom {a_{12}}{a_{22}}}} and (a12a22).{\displaystyle {\binom {a_{12}}{a_{22}}}.} Equating the areas of this last and the second parallelogram gives the equation |b1a12b2a22|=|a11x1a12a21x1a22|=x1|a11a12a21a22|{\displaystyle {\begin{vmatrix}b_{1}&a_{12}\\b_{2}&a_{22}\end{vmatrix}}={\begin{vmatrix}a_{11}x_{1}&a_{12}\\a_{21}x_{1}&a_{22}\end{vmatrix}}=x_{1}{\begin{vmatrix}a_{11}&a_{12}\\a_{21}&a_{22}\end{vmatrix}}} from which Cramer's rule follows. This is a restatement of the proof above in abstract language. Consider the map x=(x1,…,xn)↦1detA(det(A1),…,det(An)),{\displaystyle \mathbf {x} =(x_{1},\ldots ,x_{n})\mapsto {\frac {1}{\det A}}\left(\det(A_{1}),\ldots ,\det(A_{n})\right),} where Ai{\displaystyle A_{i}} is the matrix A{\displaystyle A} with x{\displaystyle \mathbf {x} } substituted in the i{\displaystyle i}th column, as in Cramer's rule. Because of linearity of determinant in every column, this map is linear. Observe that it sends the i{\displaystyle i}th column of A{\displaystyle A} to the i{\displaystyle i}th basis vector ei=(0,…,1,…,0){\displaystyle \mathbf {e} _{i}=(0,\ldots ,1,\ldots ,0)} (with 1 in the i{\displaystyle i}th place), because determinant of a matrix with a repeated column is 0. So we have a linear map which agrees with the inverse of A{\displaystyle A} on the column space; hence it agrees with A−1{\displaystyle A^{-1}} on the span of the column space. Since A{\displaystyle A} is invertible, the column vectors span all of Rn{\displaystyle \mathbb {R} ^{n}}, so our map really is the inverse of A{\displaystyle A}. Cramer's rule follows. A short proof of Cramer's rule can be given by noticing that x1{\displaystyle x_{1}} is the determinant of the matrix X1=[x100⋯0x210⋯0x301⋯0⋮⋮⋮⋱⋮xn00⋯1]{\displaystyle X_{1}={\begin{bmatrix}x_{1}&0&0&\cdots &0\\x_{2}&1&0&\cdots &0\\x_{3}&0&1&\cdots &0\\\vdots &\vdots &\vdots &\ddots &\vdots \\x_{n}&0&0&\cdots &1\end{bmatrix}}} On the other hand, assuming that our original matrix A is invertible, this matrix X1{\displaystyle X_{1}} has columns A−1b,A−1v2,…,A−1vn{\displaystyle A^{-1}\mathbf {b} ,A^{-1}\mathbf {v} _{2},\ldots ,A^{-1}\mathbf {v} _{n}}, where vn{\displaystyle \mathbf {v} _{n}} is the n-th column of the matrix A. Recall that the matrix A1{\displaystyle A_{1}} has columns b,v2,…,vn{\displaystyle \mathbf {b} ,\mathbf {v} _{2},\ldots ,\mathbf {v} _{n}}, and therefore X1=A−1A1{\displaystyle X_{1}=A^{-1}A_{1}}. Hence, by using that the determinant of the product of two matrices is the product of the determinants, we have x1=det(X1)=det(A−1)det(A1)=det(A1)det(A).{\displaystyle x_{1}=\det(X_{1})=\det(A^{-1})\det(A_{1})={\frac {\det(A_{1})}{\det(A)}}.} The proof for other xj{\displaystyle x_{j}} is similar. see here A system of equations is said to be inconsistent when there are no solutions and it is called indeterminate when there is more than one solution. For linear equations, an indeterminate system will have infinitely many solutions (if it is over an infinite field), since the solutions can be expressed in terms of one or more parameters that can take arbitrary values. Cramer's rule applies to the case where the coefficient determinant is nonzero. In the 2×2 case, if the coefficient determinant is zero, then the system is incompatible if the numerator determinants are nonzero, or indeterminate if the numerator determinants are zero. For 3×3 or higher systems, the only thing one can say when the coefficient determinant equals zero is that if any of the numerator determinants are nonzero, then the system must be inconsistent. However, having all determinants zero does not imply that the system is indeterminate. A simple example where all determinants vanish (equal zero) but the system is still incompatible is the 3×3 system x+y+z=1, x+y+z=2, x+y+z=3. Rouché–Capelli theorem Gaussian elimination Cramer, Gabriel (1750). "Introduction à l'Analyse des lignes Courbes algébriques" (in French). Geneva: Europeana. pp. 656–659. Retrieved 2012-05-18. Kosinski, A. A. (2001). "Cramer's Rule is due to Cramer". Mathematics Magazine. 74 (4): 310–312. doi:10.2307/2691101. JSTOR 2691101. MacLaurin, Colin (1748). A Treatise of Algebra, in Three Parts. Boyer, Carl B. (1968). A History of Mathematics (2nd ed.). Wiley. p. 431. Katz, Victor (2004). A History of Mathematics (Brief ed.). Pearson Education. pp. 378–379. Hedman, Bruce A. (1999). "An Earlier Date for "Cramer's Rule"" (PDF). Historia Mathematica. 26 (4): 365–368. doi:10.1006/hmat.1999.2247. S2CID 121056843. David Poole (2014). Linear Algebra: A Modern Introduction. Cengage Learning. p. 276. ISBN 978-1-285-98283-0. Joe D. Hoffman; Steven Frankel (2001). Numerical Methods for Engineers and Scientists, Second Edition. CRC Press. p. 30. ISBN 978-0-8247-0443-8. Thomas S. Shores (2007). Applied Linear Algebra and Matrix Analysis. Springer Science & Business Media. p. 132. ISBN 978-0-387-48947-6. Nicholas J. Higham (2002). Accuracy and Stability of Numerical Algorithms: Second Edition. SIAM. p. 13. ISBN 978-0-89871-521-7. Ken Habgood; Itamar Arel (2012). "A condensation-based application of Cramerʼs rule for solving large-scale linear systems". Journal of Discrete Algorithms. 10: 98–109. doi:10.1016/j.jda.2011.06.007. G.I.Malaschonok (1983). "Solution of a System of Linear Equations in an Integral Ring". USSR J. Of Comput. Math. And Math. Phys. 23: 1497–1500. arXiv:1711.09452. Zhiming Gong; M. Aldeen; L. Elsner (2002). "A note on a generalized Cramer's rule". Linear Algebra and Its Applications. 340 (1–3): 253–254. doi:10.1016/S0024-3795(01)00469-4. Levi-Civita, Tullio (1926). The Absolute Differential Calculus (Calculus of Tensors). Dover. pp. 111–112. ISBN 9780486634012. Robinson, Stephen M. (1970). "A Short Proof of Cramer's Rule". Mathematics Magazine. 43 (2): 94–95. doi:10.1080/0025570X.1970.11976018. Wikibooks has a book on the topic of: Linear Algebra/Cramer's Rule Proof of Cramer's Rule Archived 2015-09-22 at the Wayback Machine WebApp descriptively solving systems of linear equations with Cramer's Rule Online Calculator of System of linear equations Wolfram MathWorld explanation on this subject