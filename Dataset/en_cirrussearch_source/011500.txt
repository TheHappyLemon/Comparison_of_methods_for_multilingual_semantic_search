In mathematics, the Kronecker product, sometimes denoted by ⊗, is an operation on two matrices of arbitrary size resulting in a block matrix. It is a specialization of the tensor product (which is denoted by the same symbol) from vectors to matrices and gives the matrix of the tensor product linear map with respect to a standard choice of basis. The Kronecker product is to be distinguished from the usual matrix multiplication, which is an entirely different operation. The Kronecker product is also sometimes called matrix direct product. The Kronecker product is named after the German mathematician Leopold Kronecker (1823–1891), even though there is little evidence that he was the first to define and use it. The Kronecker product has also been called the Zehfuss matrix, and the Zehfuss product, after Johann Georg Zehfuss [de], who in 1858 described this matrix operation, but Kronecker product is currently the most widely used term. The misattribution to Kronecker rather than Zehfuss was due to Kurt Hensel. If A is an m × n matrix and B is a p × q matrix, then the Kronecker product A ⊗ B is the pm × qn block matrix: A⊗B=[a11B⋯a1nB⋮⋱⋮am1B⋯amnB],{\displaystyle \mathbf {A} \otimes \mathbf {B} ={\begin{bmatrix}a_{11}\mathbf {B} &\cdots &a_{1n}\mathbf {B} \\\vdots &\ddots &\vdots \\a_{m1}\mathbf {B} &\cdots &a_{mn}\mathbf {B} \end{bmatrix}},} more explicitly: A⊗B=[a11b11a11b12⋯a11b1q⋯⋯a1nb11a1nb12⋯a1nb1qa11b21a11b22⋯a11b2q⋯⋯a1nb21a1nb22⋯a1nb2q⋮⋮⋱⋮⋮⋮⋱⋮a11bp1a11bp2⋯a11bpq⋯⋯a1nbp1a1nbp2⋯a1nbpq⋮⋮⋮⋱⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮am1b11am1b12⋯am1b1q⋯⋯amnb11amnb12⋯amnb1qam1b21am1b22⋯am1b2q⋯⋯amnb21amnb22⋯amnb2q⋮⋮⋱⋮⋮⋮⋱⋮am1bp1am1bp2⋯am1bpq⋯⋯amnbp1amnbp2⋯amnbpq].{\displaystyle {\mathbf {A} \otimes \mathbf {B} }={\begin{bmatrix}a_{11}b_{11}&a_{11}b_{12}&\cdots &a_{11}b_{1q}&\cdots &\cdots &a_{1n}b_{11}&a_{1n}b_{12}&\cdots &a_{1n}b_{1q}\\a_{11}b_{21}&a_{11}b_{22}&\cdots &a_{11}b_{2q}&\cdots &\cdots &a_{1n}b_{21}&a_{1n}b_{22}&\cdots &a_{1n}b_{2q}\\\vdots &\vdots &\ddots &\vdots &&&\vdots &\vdots &\ddots &\vdots \\a_{11}b_{p1}&a_{11}b_{p2}&\cdots &a_{11}b_{pq}&\cdots &\cdots &a_{1n}b_{p1}&a_{1n}b_{p2}&\cdots &a_{1n}b_{pq}\\\vdots &\vdots &&\vdots &\ddots &&\vdots &\vdots &&\vdots \\\vdots &\vdots &&\vdots &&\ddots &\vdots &\vdots &&\vdots \\a_{m1}b_{11}&a_{m1}b_{12}&\cdots &a_{m1}b_{1q}&\cdots &\cdots &a_{mn}b_{11}&a_{mn}b_{12}&\cdots &a_{mn}b_{1q}\\a_{m1}b_{21}&a_{m1}b_{22}&\cdots &a_{m1}b_{2q}&\cdots &\cdots &a_{mn}b_{21}&a_{mn}b_{22}&\cdots &a_{mn}b_{2q}\\\vdots &\vdots &\ddots &\vdots &&&\vdots &\vdots &\ddots &\vdots \\a_{m1}b_{p1}&a_{m1}b_{p2}&\cdots &a_{m1}b_{pq}&\cdots &\cdots &a_{mn}b_{p1}&a_{mn}b_{p2}&\cdots &a_{mn}b_{pq}\end{bmatrix}}.} Using //{\displaystyle /\!/} and %{\displaystyle \%} to denote truncating integer division and remainder, respectively, and numbering the matrix elements starting from 0, one obtains (A⊗B)pr+v,qs+w=arsbvw{\displaystyle (A\otimes B)_{pr+v,qs+w}=a_{rs}b_{vw}} (A⊗B)i,j=ai//p,j//qbi%p,j%q.{\displaystyle (A\otimes B)_{i,j}=a_{i/\!/p,j/\!/q}b_{i\%p,j\%q}.} For the usual numbering starting from 1, one obtains (A⊗B)p(r−1)+v,q(s−1)+w=arsbvw{\displaystyle (A\otimes B)_{p(r-1)+v,q(s-1)+w}=a_{rs}b_{vw}} (A⊗B)i,j=a⌈i/p⌉,⌈j/q⌉b(i−1)%p+1,(j−1)%q+1.{\displaystyle (A\otimes B)_{i,j}=a_{\lceil i/p\rceil ,\lceil j/q\rceil }b_{(i-1)\%p+1,(j-1)\%q+1}.} If A and B represent linear transformations V1 → W1 and V2 → W2, respectively, then the tensor product of the two maps is represented by A ⊗ B, which is the same as V1 ⊗ V2 → W1 ⊗ W2. [1234]⊗[0567]=[1[0567]2[0567]3[0567]4[0567]]=[1×01×52×02×51×61×72×62×73×03×54×04×53×63×74×64×7]=[0501067121401502018212428].{\displaystyle {\begin{bmatrix}1&2\\3&4\\\end{bmatrix}}\otimes {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}={\begin{bmatrix}1{\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}&2{\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}\\3{\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}&4{\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}\\\end{bmatrix}}=\left[{\begin{array}{cc|cc}1\times 0&1\times 5&2\times 0&2\times 5\\1\times 6&1\times 7&2\times 6&2\times 7\\\hline 3\times 0&3\times 5&4\times 0&4\times 5\\3\times 6&3\times 7&4\times 6&4\times 7\\\end{array}}\right]=\left[{\begin{array}{cc|cc}0&5&0&10\\6&7&12&14\\\hline 0&15&0&20\\18&21&24&28\end{array}}\right].} Similarly: [1−47−233]⊗[8−9−651−3−4728−8−312−5−1]=[8−9−65−323624−2056−63−42351−3−47−41216−287−21−284928−8−3−8−3232121456−56−2112−5−1−4−8204714−35−7−161812−1024−27−181524−27−1815−268−143−9−12213−9−1221−4−16166624−24−9624−24−9−2−410236−15−336−15−3]{\displaystyle {\begin{bmatrix}1&-4&7\\-2&3&3\end{bmatrix}}\otimes {\begin{bmatrix}8&-9&-6&5\\1&-3&-4&7\\2&8&-8&-3\\1&2&-5&-1\end{bmatrix}}=\left[{\begin{array}{cccc|cccc|cccc}8&-9&-6&5&-32&36&24&-20&56&-63&-42&35\\1&-3&-4&7&-4&12&16&-28&7&-21&-28&49\\2&8&-8&-3&-8&-32&32&12&14&56&-56&-21\\1&2&-5&-1&-4&-8&20&4&7&14&-35&-7\\\hline -16&18&12&-10&24&-27&-18&15&24&-27&-18&15\\-2&6&8&-14&3&-9&-12&21&3&-9&-12&21\\-4&-16&16&6&6&24&-24&-9&6&24&-24&-9\\-2&-4&10&2&3&6&-15&-3&3&6&-15&-3\end{array}}\right]} Bilinearity and associativity: The Kronecker product is a special case of the tensor product, so it is bilinear and associative: A⊗(B+C)=A⊗B+A⊗C,(B+C)⊗A=B⊗A+C⊗A,(kA)⊗B=A⊗(kB)=k(A⊗B),(A⊗B)⊗C=A⊗(B⊗C),A⊗0=0⊗A=0,{\displaystyle {\begin{aligned}\mathbf {A} \otimes (\mathbf {B} +\mathbf {C} )&=\mathbf {A} \otimes \mathbf {B} +\mathbf {A} \otimes \mathbf {C} ,\\(\mathbf {B} +\mathbf {C} )\otimes \mathbf {A} &=\mathbf {B} \otimes \mathbf {A} +\mathbf {C} \otimes \mathbf {A} ,\\(k\mathbf {A} )\otimes \mathbf {B} &=\mathbf {A} \otimes (k\mathbf {B} )=k(\mathbf {A} \otimes \mathbf {B} ),\\(\mathbf {A} \otimes \mathbf {B} )\otimes \mathbf {C} &=\mathbf {A} \otimes (\mathbf {B} \otimes \mathbf {C} ),\\\mathbf {A} \otimes \mathbf {0} &=\mathbf {0} \otimes \mathbf {A} =\mathbf {0} ,\end{aligned}}} where A, B and C are matrices, 0 is a zero matrix, and k is a scalar. Non-commutative: In general, A ⊗ B and B ⊗ A are different matrices. However, A ⊗ B and B ⊗ A are permutation equivalent, meaning that there exist permutation matrices P and Q such that B⊗A=P(A⊗B)Q.{\displaystyle \mathbf {B} \otimes \mathbf {A} =\mathbf {P} \,(\mathbf {A} \otimes \mathbf {B} )\,\mathbf {Q} .} If A and B are square matrices, then A ⊗ B and B ⊗ A are even permutation similar, meaning that we can take P = QT. The matrices P and Q are perfect shuffle matrices. The perfect shuffle matrix Sp,q can be constructed by taking slices of the Ir identity matrix, where r=pq{\displaystyle r=pq}. Sp,q=[Ir(1:q:r,:)Ir(2:q:r,:)⋮Ir(q:q:r,:)]{\displaystyle \mathbf {S} _{p,q}={\begin{bmatrix}\mathbf {I} _{r}(1:q:r,:)\\\mathbf {I} _{r}(2:q:r,:)\\\vdots \\\mathbf {I} _{r}(q:q:r,:)\end{bmatrix}}} MATLAB colon notation is used here to indicate submatrices, and Ir is the r × r identity matrix. If A∈Rm1×n1{\displaystyle \mathbf {A} \in \mathbb {R} ^{m_{1}\times n_{1}}} and B∈Rm2×n2{\displaystyle \mathbf {B} \in \mathbb {R} ^{m_{2}\times n_{2}}}, then B⊗A=Sm1,m2(A⊗B)Sn1,n2T{\displaystyle \mathbf {B} \otimes \mathbf {A} =\mathbf {S} _{m_{1},m_{2}}(\mathbf {A} \otimes \mathbf {B} )\mathbf {S} _{n_{1},n_{2}}^{\textsf {T}}} The mixed-product property: If A, B, C and D are matrices of such size that one can form the matrix products AC and BD, then (A⊗B)(C⊗D)=(AC)⊗(BD).{\displaystyle (\mathbf {A} \otimes \mathbf {B} )(\mathbf {C} \otimes \mathbf {D} )=(\mathbf {AC} )\otimes (\mathbf {BD} ).} This is called the mixed-product property, because it mixes the ordinary matrix product and the Kronecker product. As an immediate consequence, A⊗B=(Im1⊗B)(A⊗In2)=(A⊗Im2)(In1⊗B).{\displaystyle \mathbf {A} \otimes \mathbf {B} =(\mathbf {I_{m_{1}}} \otimes \mathbf {B} )(\mathbf {A} \otimes \mathbf {I_{n_{2}}} )=(\mathbf {A} \otimes \mathbf {I_{m_{2}}} )(\mathbf {I_{n_{1}}} \otimes \mathbf {B} ).} In particular, using the transpose property from below, this means that if A=Q⊗U{\displaystyle \mathbf {A} =\mathbf {Q} \otimes \mathbf {U} } and Q and U are orthogonal (or unitary), then A is also orthogonal (resp., unitary). The mixed Kronecker matrix-vector product can be written as: (A⊗B)vec⁡(V)=vec⁡(BVAT){\displaystyle \left(\mathbf {A} \otimes \mathbf {B} \right)\operatorname {vec} \left(\mathbf {V} \right)=\operatorname {vec} (\mathbf {B} \mathbf {V} \mathbf {A} ^{T})} where vec⁡(V){\displaystyle \operatorname {vec} (\mathbf {V} )} is the vectorization operator applied on V{\displaystyle \mathbf {V} } (formed by reshaping the matrix). Hadamard product (element-wise multiplication): The mixed-product property also works for the element-wise product. If A and C are matrices of the same size, B and D are matrices of the same size, then (A⊗B)∘(C⊗D)=(A∘C)⊗(B∘D).{\displaystyle (\mathbf {A} \otimes \mathbf {B} )\circ (\mathbf {C} \otimes \mathbf {D} )=(\mathbf {A} \circ \mathbf {C} )\otimes (\mathbf {B} \circ \mathbf {D} ).} The inverse of a Kronecker product: It follows that A ⊗ B is invertible if and only if both A and B are invertible, in which case the inverse is given by (A⊗B)−1=A−1⊗B−1.{\displaystyle (\mathbf {A} \otimes \mathbf {B} )^{-1}=\mathbf {A} ^{-1}\otimes \mathbf {B} ^{-1}.} The invertible product property holds for the Moore–Penrose pseudoinverse as well, that is (A⊗B)+=A+⊗B+.{\displaystyle (\mathbf {A} \otimes \mathbf {B} )^{+}=\mathbf {A} ^{+}\otimes \mathbf {B} ^{+}.} In the language of Category theory, the mixed-product property of the Kronecker product (and more general tensor product) shows that the category MatF of matrices over a field F, is in fact a monoidal category, with objects natural numbers n, morphisms n → m are n×m matrices with entries in F, composition is given by matrix multiplication, identity arrows are simply n × n identity matrices In, and the tensor product is given by the Kronecker product. MatF is a concrete skeleton category for the equivalent category FinVectF of finite dimensional vector spaces over F, whose objects are such finite dimensional vector spaces V, arrows are F-linear maps L : V → W, and identity arrows are the identity maps of the spaces. The equivalence of categories amounts to simultaneously choosing a basis in every finite-dimensional vector space V over F; matrices' elements represent these mappings with respect to the chosen bases; and likewise the Kronecker product is the representation of the tensor product in the chosen bases. Transpose: Transposition and conjugate transposition are distributive over the Kronecker product: (A⊗B)T=AT⊗BT{\displaystyle (\mathbf {A} \otimes \mathbf {B} )^{\textsf {T}}=\mathbf {A} ^{\textsf {T}}\otimes \mathbf {B} ^{\textsf {T}}} and (A⊗B)∗=A∗⊗B∗.{\displaystyle (\mathbf {A} \otimes \mathbf {B} )^{*}=\mathbf {A} ^{*}\otimes \mathbf {B} ^{*}.} Determinant: Let A be an n × n matrix and let B be an m × m matrix. Then |A⊗B|=|A|m|B|n.{\displaystyle \left|\mathbf {A} \otimes \mathbf {B} \right|=\left|\mathbf {A} \right|^{m}\left|\mathbf {B} \right|^{n}.} The exponent in |A| is the order of B and the exponent in |B| is the order of A. Kronecker sum and exponentiation: If A is n × n, B is m × m and Ik denotes the k × k identity matrix then we can define what is sometimes called the Kronecker sum, ⊕, by A⊕B=A⊗Im+In⊗B.{\displaystyle \mathbf {A} \oplus \mathbf {B} =\mathbf {A} \otimes \mathbf {I} _{m}+\mathbf {I} _{n}\otimes \mathbf {B} .} This is different from the direct sum of two matrices. This operation is related to the tensor product on Lie algebras, as detailed below (#Abstract properties) in the point "Relation to the abstract tensor product". We have the following formula for the matrix exponential, which is useful in some numerical evaluations. exp⁡(N⊕M)=exp⁡(N)⊗exp⁡(M){\displaystyle \exp({\mathbf {N} \oplus \mathbf {M} })=\exp(\mathbf {N} )\otimes \exp(\mathbf {M} )} Kronecker sums appear naturally in physics when considering ensembles of non-interacting systems.[citation needed] Let Hk be the Hamiltonian of the kth such system. Then the total Hamiltonian of the ensemble is HTot=⨁kHk.{\displaystyle H_{\mathrm {Tot} }=\bigoplus _{k}H^{k}.} Vectorization of a Kronecker product: Let A{\displaystyle A} be an m×n{\displaystyle m\times n} matrix and B{\displaystyle B} a p×q{\displaystyle p\times q} matrix. When the order of the Kronecker product and vectorization is interchanged, the two operations can be linked linearly through a function that involves the commutation matrix. That is, vec(Kron(A,B)){\displaystyle \mathrm {vec} (\mathrm {Kron} (A,B))} and Kron(vecA,vecB){\displaystyle \mathrm {Kron} (\mathrm {vec} A,\mathrm {vec} B)} have the following relationship: vec(A⊗B)=(In⊗Kqm⊗Iq)(vecA⊗vecB).{\displaystyle \mathrm {vec} (A\otimes B)=(I_{n}\otimes K_{qm}\otimes I_{q})(\mathrm {vec} A\otimes \mathrm {vec} B).} Furthermore, the above relation can be rearranged in terms of either vecA{\displaystyle \mathrm {vec} A} or vecB{\displaystyle \mathrm {vec} B} as follows: vec(A⊗B)=(In⊗G)vecA=(H⊗Ip)vecB,{\displaystyle \mathrm {vec} (A\otimes B)=(I_{n}\otimes G)\mathrm {vec} A=(H\otimes I_{p})\mathrm {vec} B,} where G=(Kqm⊗Ip)(Im⊗vecB) and H=(In⊗Kqm)(vecA⊗Iq).{\displaystyle G=(K_{qm}\otimes I_{p})(I_{m}\otimes \mathrm {vec} B){\text{ and }}H=(I_{n}\otimes K_{qm})(\mathrm {vec} A\otimes I_{q}).} Outer Product: If x∈Rn{\displaystyle x\in \mathbb {R} ^{n}} and y∈Rm{\displaystyle y\in \mathbb {R} ^{m}} are arbitrary vectors, then the outer product between x{\displaystyle x} and y{\displaystyle y} is defined as xyT{\displaystyle xy^{T}}. The Kronecker product is related to the outer product by: y⊗x=vec(xyT){\displaystyle y\otimes x=\mathrm {vec} (xy^{T})}. Spectrum: Suppose that A and B are square matrices of size n and m respectively. Let λ1, ..., λn be the eigenvalues of A and μ1, ..., μm be those of B (listed according to multiplicity). Then the eigenvalues of A ⊗ B are λiμj,i=1,…,n,j=1,…,m.{\displaystyle \lambda _{i}\mu _{j},\qquad i=1,\ldots ,n,\,j=1,\ldots ,m.} It follows that the trace and determinant of a Kronecker product are given by tr⁡(A⊗B)=tr⁡Atr⁡Banddet(A⊗B)=(detA)m(detB)n.{\displaystyle \operatorname {tr} (\mathbf {A} \otimes \mathbf {B} )=\operatorname {tr} \mathbf {A} \,\operatorname {tr} \mathbf {B} \quad {\text{and}}\quad \det(\mathbf {A} \otimes \mathbf {B} )=(\det \mathbf {A} )^{m}(\det \mathbf {B} )^{n}.} Singular values: If A and B are rectangular matrices, then one can consider their singular values. Suppose that A has rA nonzero singular values, namely σA,i,i=1,…,rA.{\displaystyle \sigma _{\mathbf {A} ,i},\qquad i=1,\ldots ,r_{\mathbf {A} }.} Similarly, denote the nonzero singular values of B by σB,i,i=1,…,rB.{\displaystyle \sigma _{\mathbf {B} ,i},\qquad i=1,\ldots ,r_{\mathbf {B} }.} Then the Kronecker product A ⊗ B has rArB nonzero singular values, namely σA,iσB,j,i=1,…,rA,j=1,…,rB.{\displaystyle \sigma _{\mathbf {A} ,i}\sigma _{\mathbf {B} ,j},\qquad i=1,\ldots ,r_{\mathbf {A} },\,j=1,\ldots ,r_{\mathbf {B} }.} Since the rank of a matrix equals the number of nonzero singular values, we find that rank⁡(A⊗B)=rank⁡Arank⁡B.{\displaystyle \operatorname {rank} (\mathbf {A} \otimes \mathbf {B} )=\operatorname {rank} \mathbf {A} \,\operatorname {rank} \mathbf {B} .} Relation to the abstract tensor product: The Kronecker product of matrices corresponds to the abstract tensor product of linear maps. Specifically, if the vector spaces V, W, X, and Y have bases {v1, ..., vm}, {w1, ..., wn}, {x1, ..., xd}, and {y1, ..., ye}, respectively, and if the matrices A and B represent the linear transformations S : V → X and T : W → Y, respectively in the appropriate bases, then the matrix A ⊗ B represents the tensor product of the two maps, S ⊗ T : V ⊗ W → X ⊗ Y with respect to the basis {v1 ⊗ w1, v1 ⊗ w2, ..., v2 ⊗ w1, ..., vm ⊗ wn} of V ⊗ W and the similarly defined basis of X ⊗ Y with the property that A ⊗ B(vi ⊗ wj) = (Avi) ⊗ (Bwj), where i and j are integers in the proper range. When V and W are Lie algebras, and S : V → V and T : W → W are Lie algebra homomorphisms, the Kronecker sum of A and B represents the induced Lie algebra homomorphisms V ⊗ W → V ⊗ W.[citation needed] Relation to products of graphs: The Kronecker product of the adjacency matrices of two graphs is the adjacency matrix of the tensor product graph. The Kronecker sum of the adjacency matrices of two graphs is the adjacency matrix of the Cartesian product graph. The Kronecker product can be used to get a convenient representation for some matrix equations. Consider for instance the equation AXB = C, where A, B and C are given matrices and the matrix X is the unknown. We can use the "vec trick" to rewrite this equation as (BT⊗A)vec⁡(X)=vec⁡(AXB)=vec⁡(C).{\displaystyle \left(\mathbf {B} ^{\textsf {T}}\otimes \mathbf {A} \right)\,\operatorname {vec} (\mathbf {X} )=\operatorname {vec} (\mathbf {AXB} )=\operatorname {vec} (\mathbf {C} ).} Here, vec(X) denotes the vectorization of the matrix X, formed by stacking the columns of X into a single column vector. It now follows from the properties of the Kronecker product that the equation AXB = C has a unique solution, if and only if A and B are invertible (Horn & Johnson 1991, Lemma 4.3.1). If X and C are row-ordered into the column vectors u and v, respectively, then (Jain 1989, 2.8 Block Matrices and Kronecker Products) v=(A⊗BT)u.{\displaystyle \mathbf {v} =\left(\mathbf {A} \otimes \mathbf {B} ^{\textsf {T}}\right)\mathbf {u} .} The reason is that v=vec⁡((AXB)T)=vec⁡(BTXTAT)=(A⊗BT)vec⁡(XT)=(A⊗BT)u.{\displaystyle \mathbf {v} =\operatorname {vec} \left((\mathbf {AXB} )^{\textsf {T}}\right)=\operatorname {vec} \left(\mathbf {B} ^{\textsf {T}}\mathbf {X} ^{\textsf {T}}\mathbf {A} ^{\textsf {T}}\right)=\left(\mathbf {A} \otimes \mathbf {B} ^{\textsf {T}}\right)\operatorname {vec} \left(\mathbf {X^{\textsf {T}}} \right)=\left(\mathbf {A} \otimes \mathbf {B} ^{\textsf {T}}\right)\mathbf {u} .} For an example of the application of this formula, see the article on the Lyapunov equation. This formula also comes in handy in showing that the matrix normal distribution is a special case of the multivariate normal distribution. This formula is also useful for representing 2D image processing operations in matrix-vector form. Another example is when a matrix can be factored as a Kronecker product, then matrix multiplication can be performed faster by using the above formula. This can be applied recursively, as done in the radix-2 FFT and the Fast Walsh–Hadamard transform. Splitting a known matrix into the Kronecker product of two smaller matrices is known as the "nearest Kronecker product" problem, and can be solved exactly by using the SVD. To split a matrix into the Kronecker product of more than two matrices, in an optimal fashion, is a difficult problem and the subject of ongoing research; some authors cast it as a tensor decomposition problem. In conjunction with the least squares method, the Kronecker product can be used as an accurate solution to the hand–eye calibration problem. Two related matrix operations are the Tracy–Singh and Khatri–Rao products, which operate on partitioned matrices. Let the m × n matrix A be partitioned into the mi × nj blocks Aij and p × q matrix B into the pk × qℓ blocks Bkl, with of course Σi mi = m, Σj nj = n, Σk pk = p and Σℓ qℓ = q. The Tracy–Singh product is defined as A∘B=(Aij∘B)ij=((Aij⊗Bkl)kl)ij{\displaystyle \mathbf {A} \circ \mathbf {B} =\left(\mathbf {A} _{ij}\circ \mathbf {B} \right)_{ij}=\left(\left(\mathbf {A} _{ij}\otimes \mathbf {B} _{kl}\right)_{kl}\right)_{ij}} which means that the (ij)-th subblock of the mp × nq product A ∘{\displaystyle \circ } B is the mi p × nj q matrix Aij ∘{\displaystyle \circ } B, of which the (kℓ)-th subblock equals the mi pk × nj qℓ matrix Aij ⊗ Bkℓ. Essentially the Tracy–Singh product is the pairwise Kronecker product for each pair of partitions in the two matrices. For example, if A and B both are 2 × 2 partitioned matrices e.g.: A=[A11A12A21A22]=[123456789],B=[B11B12B21B22]=[147258369],{\displaystyle \mathbf {A} =\left[{\begin{array}{c | c}\mathbf {A} _{11}&\mathbf {A} _{12}\\\hline \mathbf {A} _{21}&\mathbf {A} _{22}\end{array}}\right]=\left[{\begin{array}{c c | c}1&2&3\\4&5&6\\\hline 7&8&9\end{array}}\right],\quad \mathbf {B} =\left[{\begin{array}{c | c}\mathbf {B} _{11}&\mathbf {B} _{12}\\\hline \mathbf {B} _{21}&\mathbf {B} _{22}\end{array}}\right]=\left[{\begin{array}{c | c c}1&4&7\\\hline 2&5&8\\3&6&9\end{array}}\right],} we get: A∘B=[A11∘BA12∘BA21∘BA22∘B]=[A11⊗B11A11⊗B12A12⊗B11A12⊗B12A11⊗B21A11⊗B22A12⊗B21A12⊗B22A21⊗B11A21⊗B12A22⊗B11A22⊗B12A21⊗B21A21⊗B22A22⊗B21A22⊗B22]=[1247814312214516282035624422458101661524366912189182781020322540123048121524363045183654782849325693663141635564064184572212442634872275481].{\displaystyle {\begin{aligned}\mathbf {A} \circ \mathbf {B} ={}&\left[{\begin{array}{c | c}\mathbf {A} _{11}\circ \mathbf {B} &\mathbf {A} _{12}\circ \mathbf {B} \\\hline \mathbf {A} _{21}\circ \mathbf {B} &\mathbf {A} _{22}\circ \mathbf {B} \end{array}}\right]\\={}&\left[{\begin{array}{c | c | c | c}\mathbf {A} _{11}\otimes \mathbf {B} _{11}&\mathbf {A} _{11}\otimes \mathbf {B} _{12}&\mathbf {A} _{12}\otimes \mathbf {B} _{11}&\mathbf {A} _{12}\otimes \mathbf {B} _{12}\\\hline \mathbf {A} _{11}\otimes \mathbf {B} _{21}&\mathbf {A} _{11}\otimes \mathbf {B} _{22}&\mathbf {A} _{12}\otimes \mathbf {B} _{21}&\mathbf {A} _{12}\otimes \mathbf {B} _{22}\\\hline \mathbf {A} _{21}\otimes \mathbf {B} _{11}&\mathbf {A} _{21}\otimes \mathbf {B} _{12}&\mathbf {A} _{22}\otimes \mathbf {B} _{11}&\mathbf {A} _{22}\otimes \mathbf {B} _{12}\\\hline \mathbf {A} _{21}\otimes \mathbf {B} _{21}&\mathbf {A} _{21}\otimes \mathbf {B} _{22}&\mathbf {A} _{22}\otimes \mathbf {B} _{21}&\mathbf {A} _{22}\otimes \mathbf {B} _{22}\end{array}}\right]\\={}&\left[{\begin{array}{c c | c c c c | c | c c}1&2&4&7&8&14&3&12&21\\4&5&16&28&20&35&6&24&42\\\hline 2&4&5&8&10&16&6&15&24\\3&6&6&9&12&18&9&18&27\\8&10&20&32&25&40&12&30&48\\12&15&24&36&30&45&18&36&54\\\hline 7&8&28&49&32&56&9&36&63\\\hline 14&16&35&56&40&64&18&45&72\\21&24&42&63&48&72&27&54&81\end{array}}\right].\end{aligned}}} Block Kronecker product Column-wise Khatri–Rao product Mixed-products properties A⊗(B∙C)=(A⊗B)∙C,{\displaystyle \mathbf {A} \otimes (\mathbf {B} \bullet \mathbf {C} )=(\mathbf {A} \otimes \mathbf {B} )\bullet \mathbf {C} ,} where ∙{\displaystyle \bullet } denotes the Face-splitting product. (A∙B)(C⊗D)=(AC)∙(BD),{\displaystyle (\mathbf {A} \bullet \mathbf {B} )(\mathbf {C} \otimes \mathbf {D} )=(\mathbf {A} \mathbf {C} )\bullet (\mathbf {B} \mathbf {D} ),} Similarly: (A∙L)(B⊗M)⋯(C⊗S)=(AB⋯C)∙(LM⋯S),{\displaystyle (\mathbf {A} \bullet \mathbf {L} )(\mathbf {B} \otimes \mathbf {M} )\cdots (\mathbf {C} \otimes \mathbf {S} )=(\mathbf {A} \mathbf {B} \cdots \mathbf {C} )\bullet (\mathbf {L} \mathbf {M} \cdots \mathbf {S} ),} cT∙dT=cT⊗dT,{\displaystyle \mathbf {c} ^{\textsf {T}}\bullet \mathbf {d} ^{\textsf {T}}=\mathbf {c} ^{\textsf {T}}\otimes \mathbf {d} ^{\textsf {T}},} where c{\displaystyle \mathbf {c} } and d{\displaystyle \mathbf {d} } are vectors, (A∙B)(c⊗d)=(Ac)∘(Bd),{\displaystyle (\mathbf {A} \bullet \mathbf {B} )(\mathbf {c} \otimes \mathbf {d} )=(\mathbf {A} \mathbf {c} )\circ (\mathbf {B} \mathbf {d} ),} where c{\displaystyle \mathbf {c} } and d{\displaystyle \mathbf {d} } are vectors, and ∘{\displaystyle \circ } denotes the Hadamard product. Similarly: (A∙B)(MNc⊗QPd)=(AMNc)∘(BQPd),{\displaystyle (\mathbf {A} \bullet \mathbf {B} )(\mathbf {M} \mathbf {N} \mathbf {c} \otimes \mathbf {Q} \mathbf {P} \mathbf {d} )=(\mathbf {A} \mathbf {M} \mathbf {N} \mathbf {c} )\circ (\mathbf {B} \mathbf {Q} \mathbf {P} \mathbf {d} ),} F(C(1)x⋆C(2)y)=(FC(1)∙FC(2))(x⊗y)=FC(1)x∘FC(2)y{\displaystyle {\mathcal {F}}(C^{(1)}x\star C^{(2)}y)=({\mathcal {F}}C^{(1)}\bullet {\mathcal {F}}C^{(2)})(x\otimes y)={\mathcal {F}}C^{(1)}x\circ {\mathcal {F}}C^{(2)}y}, where ⋆{\displaystyle \star } is vector convolution and F{\displaystyle {\mathcal {F}}} is the Fourier transform matrix (this result is an evolving of count sketch properties), (A∙L)(B⊗M)⋯(C⊗S)(K∗T)=(AB⋅CK)∘(LM⋯ST),{\displaystyle (\mathbf {A} \bullet \mathbf {L} )(\mathbf {B} \otimes \mathbf {M} )\cdots (\mathbf {C} \otimes \mathbf {S} )(\mathbf {K} \ast \mathbf {T} )=(\mathbf {A} \mathbf {B} \cdot \mathbf {C} \mathbf {K} )\circ (\mathbf {L} \mathbf {M} \cdots \mathbf {S} \mathbf {T} ),} where ∗{\displaystyle \ast } denotes the Column-wise Khatri–Rao product. Similarly: (A∙L)(B⊗M)⋯(C⊗S)(c⊗d)=(AB⋯Cc)∘(LM⋯Sd),{\displaystyle (\mathbf {A} \bullet \mathbf {L} )(\mathbf {B} \otimes \mathbf {M} )\cdots (\mathbf {C} \otimes \mathbf {S} )(c\otimes d)=(\mathbf {A} \mathbf {B} \cdots \mathbf {C} \mathbf {c} )\circ (\mathbf {L} \mathbf {M} \cdots \mathbf {S} \mathbf {d} ),} (A∙L)(B⊗M)⋯(C⊗S)(Pc⊗Qd)=(AB⋯CPc)∘(LM⋯SQd),{\displaystyle (\mathbf {A} \bullet \mathbf {L} )(\mathbf {B} \otimes \mathbf {M} )\cdots (\mathbf {C} \otimes \mathbf {S} )(\mathbf {P} \mathbf {c} \otimes \mathbf {Q} \mathbf {d} )=(\mathbf {A} \mathbf {B} \cdots \mathbf {C} \mathbf {P} \mathbf {c} )\circ (\mathbf {L} \mathbf {M} \cdots \mathbf {S} \mathbf {Q} \mathbf {d} ),} where c{\displaystyle \mathbf {c} } and d{\displaystyle \mathbf {d} } are vectors. Generalized linear array model Hadamard product (matrices) Kronecker coefficient Weisstein, Eric W. "Kronecker product". mathworld.wolfram.com. Retrieved 2020-09-06. Zehfuss, G. (1858). "Ueber eine gewisse Determinante". Zeitschrift für Mathematik und Physik. 3: 298–301. Henderson, Harold V.; Pukelsheim, Friedrich; Searle, Shayle R. (1983). "On the history of the kronecker product". Linear and Multilinear Algebra. 14 (2): 113–120. doi:10.1080/03081088308817548. hdl:1813/32834. ISSN 0308-1087. Sayed, Ali H. (2022-12-22). Inference and Learning from Data: Foundations. Cambridge University Press. ISBN 978-1-009-21812-2. Henderson, H.V.; Searle, S.R. (1980). "The vec-permutation matrix, the vec operator and Kronecker products: A review" (PDF). Linear and Multilinear Algebra. 9 (4): 271–288. doi:10.1080/03081088108817379. hdl:1813/32747. Van Loan, Charles F. (2000). "The ubiquitous Kronecker product". Journal of Computational and Applied Mathematics. 123 (1–2): 85–100. Bibcode:2000JCoAM.123...85L. doi:10.1016/s0377-0427(00)00393-9. Liu, Shuangzhe; Trenkler, Götz; Kollo, Tõnu; von Rosen, Dietrich; Baksalary, Oskar Maria (2023). "Professor Heinz Neudecker and matrix differential calculus". Statistical Papers. doi:10.1007/s00362-023-01499-w. Langville, Amy N.; Stewart, William J. (1 June 2004). "The Kronecker product and stochastic automata networks". Journal of Computational and Applied Mathematics. 167 (2): 429–447. Bibcode:2004JCoAM.167..429L. doi:10.1016/j.cam.2003.10.010. Macedo, Hugo Daniel; Oliveira, José Nuno (2013). "Typing linear algebra: A biproduct-oriented approach". Science of Computer Programming. 78 (11): 2160–2191. arXiv:1312.4818. Bibcode:2013arXiv1312.4818M. CiteSeerX 10.1.1.747.2083. doi:10.1016/j.scico.2012.07.012. S2CID 9846072. Brewer, J.W. (1969). "A note on Kronecker matrix products and matrix equation systems". SIAM Journal on Applied Mathematics. 17 (3): 603–606. doi:10.1137/0117057. Dummit, David S.; Foote, Richard M. (1999). Abstract Algebra (2 ed.). New York: John Wiley and Sons. pp. 401–402. ISBN 978-0-471-36857-1. See Knuth, D.E. "Pre-Fascicle 0a: Introduction to Combinatorial Algorithms" (zeroth printing, revision 2 ed.). answer to Exercise 96. Archived from the original on 2019-05-13. Retrieved 2007-10-24, to appear as part of Knuth, D.E. The Art of Computer Programming. Vol. 4A. Van Loan, C.; Pitsianis, N. (1992). Approximation with Kronecker Products. Ithaca, NY: Cornell University Press. King Keung Wu; Yam, Yeung; Meng, Helen; Mesbahi, Mehran (2016). "Kronecker product approximation with multiple factor matrices via the tensor product algorithm". 2016 IEEE International Conference on Systems, Man, and Cybernetics (SMC). pp. 004277–004282. doi:10.1109/SMC.2016.7844903. ISBN 978-1-5090-1897-0. S2CID 30695585. Dantas, Cássio F.; Cohen, Jérémy E.; Gribonval, Rémi (2018). "Learning Fast Dictionaries for Sparse Representations Using Low-Rank Tensor Decompositions". Latent Variable Analysis and Signal Separation (PDF). Lecture Notes in Computer Science. Vol. 10891. pp. 456–466. doi:10.1007/978-3-319-93764-9_42. ISBN 978-3-319-93763-2. S2CID 46963798. Li, Algo; et al. (4 September 2010). "Simultaneous robot-world and hand-eye calibration using dual-quaternions and Kronecker product" (PDF). International Journal of the Physical Sciences. 5 (10): 1530–1536. S2CID 7446157. Archived from the original (PDF) on 9 February 2020. Tracy, D.S.; Singh, R.P. (1972). "A new matrix product and its applications in matrix differentiation". Statistica Neerlandica. 26 (4): 143–157. doi:10.1111/j.1467-9574.1972.tb00199.x. Liu, Shuangzhe (1999). "Matrix Results on the Khatri–Rao and Tracy–Singh Products". Linear Algebra and Its Applications. 289 (1–3): 267–277. doi:10.1016/S0024-3795(98)10209-4. Liu, Shuangzhe; Trenkler, Götz (2008). "Hadamard, Khatri-Rao, Kronecker and other matrix products". International Journal of Information and Systems Sciences. 4 (1): 160–177. Slyusar, V.I. (1998) [27 December 1996]. "End products in matrices in radar applications" (PDF). Radioelectronics and Communications Systems. 41 (3): 50–53. Slyusar, Vadym (1999). "New matrix operations for DSP" (self-published lecture). doi:10.13140/RG.2.2.31620.76164/1 – via ResearchGate. {{cite journal}}: Cite journal requires |journal= (help) Slyusar, V.I. (March 13, 1998). "A Family of Face Products of Matrices and its Properties" (PDF). Cybernetics and Systems Analysis C/C of Kibernetika I Sistemnyi Analiz. 1999. 35 (3): 379–384. doi:10.1007/BF02733426. S2CID 119661450. Slyusar, V.I. (1997-09-15). New operations of matrices product for applications of radars (PDF). Direct and Inverse Problems of Electromagnetic and Acoustic Wave Theory (DIPED-97), Lviv. pp. 73–74. Ahle, Thomas Dybdahl; Knudsen, Jakob Bæk Tejs (2019-09-03). "Almost optimal tensor sketch". arXiv:1909.01821 [cs.DS]. Ninh, Pham; Pagh, Rasmus (2013). Fast and scalable polynomial kernels via explicit feature maps. SIGKDD international conference on Knowledge discovery and data mining. Association for Computing Machinery. CiteSeerX 10.1.1.718.2766. doi:10.1145/2487575.2487591. Horn, Roger A.; Johnson, Charles R. (1991). Topics in Matrix Analysis. Cambridge University Press. ISBN 978-0-521-46713-1. Jain, Anil K. (1989). Fundamentals of Digital Image Processing. Prentice Hall. Bibcode:1989fdip.book.....J. ISBN 978-0-13-336165-0. Steeb, Willi-Hans (1997). Matrix Calculus and Kronecker Product with Applications and C++ Programs. World Scientific Publishing. ISBN 978-981-02-3241-2. Steeb, Willi-Hans (2006). Problems and Solutions in Introductory and Advanced Matrix Calculus. World Scientific Publishing. ISBN 978-981-256-916-5. Liu, Shuangzhe; Trenkler, Götz (2008), "Hadamard, Khatri-Rao, Kronecker and other matrix products", International Journal of Information and Systems Sciences, 4: 160–177 "Tensor product", Encyclopedia of Mathematics, EMS Press, 2001 [1994] "Kronecker product". PlanetMath. "Kronecker product". MathWorld. "New Kronecker product problems" (PDF). "Earliest uses". The entry on the Kronecker, Zehfuss, or Direct Product of matrices has historical information. calculate Kronecker product of two matrices. SourceForge (generic C++ and Fortran 90 source code). 2015-06-27. "Kronecker product". RosettaCode.org. 31 December 2020. Retrieved 2021-01-13. Software source in more than 40 languages.